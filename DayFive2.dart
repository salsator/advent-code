/*--- Day 5: Cafeteria ---
As the forklifts break through the wall, the Elves are delighted to discover that there was a cafeteria on the other side after all.

You can hear a commotion coming from the kitchen. "At this rate, we won't have any time left to put the wreaths up in the dining hall!" Resolute in your quest, you investigate.

"If only we hadn't switched to the new inventory management system right before Christmas!" another Elf exclaims. You ask what's going on.

The Elves in the kitchen explain the situation: because of their complicated new inventory management system, they can't figure out which of their ingredients are fresh and which are spoiled. When you ask how it works, they give you a copy of their database (your puzzle input).

The database operates on ingredient IDs. It consists of a list of fresh ingredient ID ranges, a blank line, and a list of available ingredient IDs. For example:

3-5
10-14
16-20
12-18

1
5
8
11
17
32
The fresh ID ranges are inclusive: the range 3-5 means that ingredient IDs 3, 4, and 5 are all fresh. The ranges can also overlap; an ingredient ID is fresh if it is in any range.

The Elves are trying to determine which of the available ingredient IDs are fresh. In this example, this is done as follows:

Ingredient ID 1 is spoiled because it does not fall into any range.
Ingredient ID 5 is fresh because it falls into range 3-5.
Ingredient ID 8 is spoiled.
Ingredient ID 11 is fresh because it falls into range 10-14.
Ingredient ID 17 is fresh because it falls into range 16-20 as well as range 12-18.
Ingredient ID 32 is spoiled.
So, in this example, 3 of the available ingredient IDs are fresh.

Process the database file from the new inventory management system. How many of the available ingredient IDs are fresh?

Your puzzle answer was 509.

--- Part Two ---
The Elves start bringing their spoiled inventory to the trash chute at the back of the kitchen.

So that they can stop bugging you when they get new inventory, the Elves would like to know all of the IDs that the fresh ingredient ID ranges consider to be fresh. An ingredient ID is still considered fresh if it is in any range.

Now, the second section of the database (the available ingredient IDs) is irrelevant. Here are the fresh ingredient ID ranges from the above example:

3-5
10-14
16-20
12-18
The ingredient IDs that these ranges consider to be fresh are 3, 4, 5, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, and 20. So, in this example, the fresh ingredient ID ranges consider a total of 14 ingredient IDs to be fresh.

Process the database file again. How many ingredient IDs are considered to be fresh according to the fresh ingredient ID ranges?

Your puzzle answer was 336790092076620.
*/

void main() {
  List<String> rangesLines = ranges.split('\n');
  int result = 0;
  List<List<int>> resultDuo = [];
  List<List<int>> rangesDuo = [];
  for (var range in rangesLines) {
    int start = int.parse(range.split("-")[0]);
    int end = int.parse(range.split("-")[1]);
    rangesDuo.add([start, end]);
  }
  rangesDuo.sort((a, b) => a[0].compareTo(b[0]));
  var currentRange = rangesDuo[0];

  for (int i = 1; i < rangesDuo.length; i++) {
    if (rangesDuo[i][0] <= currentRange[1] &&
        rangesDuo[i][1] > currentRange[1]) {
      currentRange[1] = rangesDuo[i][1];
    }
    if (rangesDuo[i][0] > currentRange[1]) {
      resultDuo.add(currentRange);
      currentRange = rangesDuo[i];
    }
  }
  resultDuo.add(currentRange);

  resultDuo.forEach((range) {
    result += (range[1] - range[0] + 1);
  });
  print(result);
}

String ranges = '''335974207908975-335974207908975
166378971253254-166378971253254
202256907733789-202256907733789
21286600651630-24648609504166
558745805536874-559599518272636
435394114820892-441719509061826
174441875641519-175271524124959
92531249332742-97299413301312
513484599234147-520481731528370
173874995893993-174120643897356
174821166255466-175271524124959
293613115143021-293613115143021
425676293461608-427469272423527
261699778868308-267782959886821
62792025293181-64427754150033
213359143863329-216920173874119
485300942212668-489793905834071
13378432871871-18518223043577
175718286653119-176590936466342
193998237963829-197306069406792
224922375146937-226805648022207
485300942212668-487043192651483
560583161419561-561040752839097
335974207908976-340360894525194
173492439912652-173874995893993
456128568685693-461311211763581
554853132666292-555060503953561
345187503361263-351437898258577
415331359030508-416758070551384
175718286653119-176131896992802
559865818114046-559990685160468
504484787497948-511084091741178
41812357709935-46323709619503
400944889652503-401137154895499
38566586092786-38566586092786
71063392748694-78768155867248
88401531130325-90283598868170
366212386842113-369559574733375
41812357709935-49638287193527
80820430981784-82386862701922
392205177095718-392504737949797
248578080710452-250780185041297
473027494433883-479114462366037
555860029504106-556466347855858
414519044783763-415742529794645
233578509446508-236721976075246
122852185571020-126919155995876
318807362064738-318807362064738
559990685160468-560583161419561
241484697563377-243682180887337
197306069406793-199659117082727
132511850415150-138777911998374
402736436544865-411103997061827
226805648022208-226805648022208
393924466477451-394165734508863
418277983121492-419855611026273
176388216880188-176590936466342
115216308429265-115634137713851
397880740944623-398712454597673
356534427403335-360529778470432
244741606128524-246874615680412
274184272176093-276891099082351
553786879235470-554225646956219
441719509061827-441719509061827
497223143248878-499936465753045
543649640475870-550684888609470
375914800960974-380372536476131
400723725598098-401137154895499
429547893930521-431760667174505
400053049630881-400514724465965
554225646956219-554853132666292
135239239818335-138777911998374
182027374246065-189422637659825
144155552966923-144155552966923
87392235254912-89213336560437
283530251930645-285296872972707
213359143863329-216920173874119
380372536476131-380372536476131
156220005513438-158084001614371
854928928779-854928928779
82779951437902-84787684996565
533710125364597-539267469576012
264489803972606-271074611857554
854928928779-8566391540121
119445951907973-120022385782033
13378432871871-18518223043577
354155862714865-360529778470432
455264846030324-456128568685692
494219560192751-499936465753045
406873622656898-408148431482032
468585580330055-471967905222337
383865841363033-390795142574897
427014313885862-428814784979861
559599518272636-559990685160468
559599518272636-560410632727482
504484787497947-504484787497947
64427754150034-67890971713727
233578509446508-239818719089833
416411266176555-417812862711511
24648609504168-29263080242135
314869508360391-318807362064737
560583161419561-561040752839097
111419310349724-112233031390255
110883288953568-111665610587406
399209502052219-400053049630881
561040752839097-561316255371618
112233031390255-112666262934332
324828185977870-328086858004231
324828185977870-328086858004231
107587576693307-107587576693307
524080596593938-532342489388312
417390509854428-419093317118083
394413024861195-394757137029331
112666262934332-113317864269805
446662754943806-450103995140459
85221235761715-87036012386502
31473941440477-38566586092786
412514374136009-413804208813214
343730583502464-348034601898665
92531249332741-92531249332741
383865841363033-386606350017845
111419310349724-111665610587406
559246284857000-559990685160468
165182752983584-166378971253254
543649640475870-543649640475870
246083189515790-247908798756856
420256891645835-421932264678660
173380777142810-174120643897356
144155552966924-147110359740417
101753444912368-107587576693306
119091563626635-119445951907973
285296872972708-289812470209470
400288079402009-400723725598098
113008816697274-113662773409190
424135858939915-425998486358274
174975048817048-175271524124959
428496401741058-430734630493823
464500784968198-468585580330053
303866335136566-307890118348895
202256907733789-210125636959977
124455006477459-129196124218540
394413024861195-395118980044980
413587981094322-414864801923854
419335851296203-420942147944880
86107799660651-87988102400429
526807835244889-528743093879030
446662754943806-450103995140459
253843593355425-258292954265193
84158911770863-85542009864131
422677329720344-424462640002629
152176426627367-158084001614371
113878761125354-114156526358922
247249187230399-249243372682639
276891099082353-280656369807064
539267469576012-539267469576012
395905589789358-396469906815526
172496676347961-173001774144952
476653069393498-481331058855155
81957654709794-83295826585653
242969727811069-244959373538347
74394496875907-76781648657372
363577973505683-366212386842111
293613115143021-298938356609908
118225058422162-118558339178687
395118980044980-395905589789358
52883578495993-56916924366480
183815199442521-188204070048092''';
